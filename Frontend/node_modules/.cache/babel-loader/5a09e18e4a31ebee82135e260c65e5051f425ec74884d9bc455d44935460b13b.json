{"ast":null,"code":"import _objectSpread from\"C:/QRail/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import AssetSearch from'./AssetSearch';import AssetTable from'./AssetTable';import'./AssetList.css';import AssetMobileCard from'./AssetMobileCard';import AddAssetModal from'./AddAssetModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AssetList=_ref=>{let{permissions}=_ref;const[assets,setAssets]=useState([]);const[searchTerm,setSearchTerm]=useState('');const[filteredAssets,setFilteredAssets]=useState([]);const[showAddModal,setShowAddModal]=useState(false);const[editAsset,setEditAsset]=useState(null);// Fetch assets from backend API\nconst fetchAssets=async()=>{try{const response=await fetch('/api/assets',{credentials:'include'});const data=await response.json();// Normalize asset data: convert snake_case to camelCase for consistency\nconst normalizedAssets=(data.assets||[]).map(asset=>_objectSpread(_objectSpread({},asset),{},{assetId:asset.asset_id||asset.assetId,asset_id:asset.asset_id||asset.assetId,mfgDate:asset.manufacturing_date||asset.mfg_date||asset.mfgDate,manufacturer:asset.manufacturer,type:asset.type,status:asset.status,hasQR:asset.hasQR||asset.has_qr||false}));setAssets(normalizedAssets);setFilteredAssets(normalizedAssets);}catch(error){console.error('Failed to load assets:',error);setAssets([]);setFilteredAssets([]);}};useEffect(()=>{fetchAssets();},[]);// Enhanced filter - search across Asset ID, Type, Manufacturer, and Status\nuseEffect(()=>{if(!searchTerm.trim()){setFilteredAssets(assets);}else{const lower=searchTerm.toLowerCase();setFilteredAssets(assets.filter(asset=>{const assetId=(asset.assetId||asset.asset_id||'').toString().toLowerCase();const type=(asset.type||'').toLowerCase();const manufacturer=(asset.manufacturer||asset.manufacturer_id||asset.manufacturerId||'').toString().toLowerCase();const status=(asset.status||'').toLowerCase();return assetId.includes(lower)||type.includes(lower)||manufacturer.includes(lower)||status.includes(lower);}));}},[searchTerm,assets]);const openAddModal=()=>{setEditAsset(null);setShowAddModal(true);};const openEditModal=asset=>{setEditAsset(asset);setShowAddModal(true);};const closeModal=()=>{setShowAddModal(false);setEditAsset(null);};const onSaveAsset=()=>{fetchAssets();closeModal();};return/*#__PURE__*/_jsxs(\"div\",{className:\"asset-list-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header flex justify-between items-center mobile-stack\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header-content flex-col gap-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"page-title\",children:\"Asset Management\"}),/*#__PURE__*/_jsx(\"p\",{className:\"page-subtitle hide-mobile\",children:\"Manage your railway assets with intelligent tracking\"})]}),permissions&&permissions.canAddAsset&&/*#__PURE__*/_jsxs(\"button\",{onClick:openAddModal,className:\"md-button add-asset-btn mobile-full-width\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"material-icons-round\",children:\"add\"}),\"Add New Asset\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card p-24 p-tablet-20 p-mobile-16\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex-col gap-24 mobile-gap-16\",children:[/*#__PURE__*/_jsx(AssetSearch,{searchTerm:searchTerm,setSearchTerm:setSearchTerm}),searchTerm&&/*#__PURE__*/_jsx(\"div\",{className:\"search-results-info\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"results-count\",children:[\"Found \",/*#__PURE__*/_jsx(\"strong\",{children:filteredAssets.length}),\" asset\",filteredAssets.length!==1?'s':'',searchTerm&&\" matching \\\"\".concat(searchTerm,\"\\\"\")]})}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsx(AssetTable,{assets:filteredAssets,onEdit:openEditModal,canDelete:permissions===null||permissions===void 0?void 0:permissions.canDeleteAsset})})]})}),/*#__PURE__*/_jsx(AddAssetModal,{isOpen:showAddModal,asset:editAsset,onClose:closeModal,onSave:onSaveAsset})]});};export default AssetList;","map":{"version":3,"names":["React","useState","useEffect","AssetSearch","AssetTable","AssetMobileCard","AddAssetModal","jsx","_jsx","jsxs","_jsxs","AssetList","_ref","permissions","assets","setAssets","searchTerm","setSearchTerm","filteredAssets","setFilteredAssets","showAddModal","setShowAddModal","editAsset","setEditAsset","fetchAssets","response","fetch","credentials","data","json","normalizedAssets","map","asset","_objectSpread","assetId","asset_id","mfgDate","manufacturing_date","mfg_date","manufacturer","type","status","hasQR","has_qr","error","console","trim","lower","toLowerCase","filter","toString","manufacturer_id","manufacturerId","includes","openAddModal","openEditModal","closeModal","onSaveAsset","className","children","canAddAsset","onClick","length","concat","onEdit","canDelete","canDeleteAsset","isOpen","onClose","onSave"],"sources":["C:/QRail/Frontend/src/components/Assets/AssetList.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport AssetSearch from './AssetSearch';\r\nimport AssetTable from './AssetTable';\r\nimport './AssetList.css';\r\nimport AssetMobileCard from './AssetMobileCard';\r\nimport AddAssetModal from './AddAssetModal';\r\n\r\nconst AssetList = ({ permissions }) => {\r\n  const [assets, setAssets] = useState([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [filteredAssets, setFilteredAssets] = useState([]);\r\n  const [showAddModal, setShowAddModal] = useState(false);\r\n  const [editAsset, setEditAsset] = useState(null);\r\n\r\n  // Fetch assets from backend API\r\n  const fetchAssets = async () => {\r\n    try {\r\n      const response = await fetch('/api/assets', { credentials: 'include' });\r\n      const data = await response.json();\r\n\r\n      // Normalize asset data: convert snake_case to camelCase for consistency\r\n      const normalizedAssets = (data.assets || []).map(asset => ({\r\n        ...asset,\r\n        assetId: asset.asset_id || asset.assetId,\r\n        asset_id: asset.asset_id || asset.assetId,\r\n        mfgDate: asset.manufacturing_date || asset.mfg_date || asset.mfgDate,\r\n        manufacturer: asset.manufacturer,\r\n        type: asset.type,\r\n        status: asset.status,\r\n        hasQR: asset.hasQR || asset.has_qr || false,\r\n      }));\r\n\r\n      setAssets(normalizedAssets);\r\n      setFilteredAssets(normalizedAssets);\r\n    } catch (error) {\r\n      console.error('Failed to load assets:', error);\r\n      setAssets([]);\r\n      setFilteredAssets([]);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchAssets();\r\n  }, []);\r\n\r\n  // Enhanced filter - search across Asset ID, Type, Manufacturer, and Status\r\n  useEffect(() => {\r\n    if (!searchTerm.trim()) {\r\n      setFilteredAssets(assets);\r\n    } else {\r\n      const lower = searchTerm.toLowerCase();\r\n      setFilteredAssets(\r\n        assets.filter(asset => {\r\n          const assetId = (asset.assetId || asset.asset_id || '').toString().toLowerCase();\r\n          const type = (asset.type || '').toLowerCase();\r\n          const manufacturer = (asset.manufacturer || asset.manufacturer_id || asset.manufacturerId || '').toString().toLowerCase();\r\n          const status = (asset.status || '').toLowerCase();\r\n          \r\n          return (\r\n            assetId.includes(lower) ||\r\n            type.includes(lower) ||\r\n            manufacturer.includes(lower) ||\r\n            status.includes(lower)\r\n          );\r\n        })\r\n      );\r\n    }\r\n  }, [searchTerm, assets]);\r\n\r\n  const openAddModal = () => {\r\n    setEditAsset(null);\r\n    setShowAddModal(true);\r\n  };\r\n\r\n  const openEditModal = (asset) => {\r\n    setEditAsset(asset);\r\n    setShowAddModal(true);\r\n  };\r\n\r\n  const closeModal = () => {\r\n    setShowAddModal(false);\r\n    setEditAsset(null);\r\n  };\r\n\r\n  const onSaveAsset = () => {\r\n    fetchAssets();\r\n    closeModal();\r\n  };\r\n\r\n  return (\r\n    <div className=\"asset-list-container\">\r\n      <div className=\"page-header flex justify-between items-center mobile-stack\">\r\n        <div className=\"header-content flex-col gap-8\">\r\n          <h2 className=\"page-title\">Asset Management</h2>\r\n          <p className=\"page-subtitle hide-mobile\">Manage your railway assets with intelligent tracking</p>\r\n        </div>\r\n        {permissions && permissions.canAddAsset && (\r\n          <button onClick={openAddModal} className=\"md-button add-asset-btn mobile-full-width\">\r\n            <span className=\"material-icons-round\">add</span>\r\n            Add New Asset\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"card p-24 p-tablet-20 p-mobile-16\">\r\n        <div className=\"flex-col gap-24 mobile-gap-16\">\r\n          <AssetSearch searchTerm={searchTerm} setSearchTerm={setSearchTerm} />\r\n          \r\n          {/* Results count */}\r\n          {searchTerm && (\r\n            <div className=\"search-results-info\">\r\n              <p className=\"results-count\">\r\n                Found <strong>{filteredAssets.length}</strong> asset{filteredAssets.length !== 1 ? 's' : ''} \r\n                {searchTerm && ` matching \"${searchTerm}\"`}\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"table-container\">\r\n            <AssetTable\r\n              assets={filteredAssets}\r\n              onEdit={openEditModal}\r\n              canDelete={permissions?.canDeleteAsset}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <AddAssetModal\r\n        isOpen={showAddModal}\r\n        asset={editAsset}\r\n        onClose={closeModal}\r\n        onSave={onSaveAsset}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AssetList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}