{"ast":null,"code":"var _jsxFileName = \"C:\\\\QRail\\\\Frontend\\\\src\\\\components\\\\Maintenance\\\\MaintenanceInput.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport './MaintenanceInput.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MaintenanceInput = ({\n  onSubmit,\n  initialValue = ''\n}) => {\n  _s();\n  const [description, setDescription] = useState(initialValue);\n  const [isListening, setIsListening] = useState(false);\n  const [isEnhancing, setIsEnhancing] = useState(false);\n  const [isProcessingSpeech, setIsProcessingSpeech] = useState(false);\n  const [speechSupported, setSpeechSupported] = useState(false);\n  const [selectedLanguage, setSelectedLanguage] = useState('hi');\n  const [supportedLanguages, setSupportedLanguages] = useState([]);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n\n  // Sync with parent's initialValue changes\n  useEffect(() => {\n    setDescription(initialValue);\n  }, [initialValue]);\n\n  // Notify parent of description changes\n  useEffect(() => {\n    if (onSubmit) {\n      onSubmit(description);\n    }\n  }, [description, onSubmit]);\n\n  // Load supported languages on mount\n  useEffect(() => {\n    fetchSupportedLanguages();\n    checkAudioSupport();\n  }, []);\n  const fetchSupportedLanguages = async () => {\n    try {\n      const response = await fetch('/api/speech/languages', {\n        credentials: 'include'\n      });\n      const data = await response.json();\n      if (data.success) {\n        setSupportedLanguages(data.languages);\n      }\n    } catch (err) {\n      console.error('Failed to load languages:', err);\n      // Fallback languages\n      setSupportedLanguages([{\n        code: 'hi',\n        name: 'Hindi',\n        native: '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä'\n      }, {\n        code: 'gu',\n        name: 'Gujarati',\n        native: '‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä'\n      }, {\n        code: 'ta',\n        name: 'Tamil',\n        native: '‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç'\n      }, {\n        code: 'te',\n        name: 'Telugu',\n        native: '‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å'\n      }, {\n        code: 'bn',\n        name: 'Bengali',\n        native: '‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ'\n      }, {\n        code: 'mr',\n        name: 'Marathi',\n        native: '‡§Æ‡§∞‡§æ‡§†‡•Ä'\n      }, {\n        code: 'kn',\n        name: 'Kannada',\n        native: '‡≤ï‡≤®‡≥ç‡≤®‡≤°'\n      }, {\n        code: 'ml',\n        name: 'Malayalam',\n        native: '‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç'\n      }, {\n        code: 'pa',\n        name: 'Punjabi',\n        native: '‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä'\n      }, {\n        code: 'or',\n        name: 'Odia',\n        native: '‡¨ì‡¨°‡¨º‡¨ø‡¨Ü'\n      }]);\n    }\n  };\n  const checkAudioSupport = () => {\n    var _navigator$mediaDevic;\n    const hasMediaRecorder = !!((_navigator$mediaDevic = navigator.mediaDevices) !== null && _navigator$mediaDevic !== void 0 && _navigator$mediaDevic.getUserMedia);\n    setSpeechSupported(hasMediaRecorder);\n    if (!hasMediaRecorder) {\n      console.warn('MediaRecorder API not supported in this browser');\n    }\n  };\n  const startRecording = async () => {\n    if (!speechSupported) {\n      setError('Audio recording is not supported in your browser. Please use Chrome, Edge, or Firefox.');\n      return;\n    }\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          sampleRate: 16000\n        }\n      });\n      mediaRecorderRef.current = new MediaRecorder(stream, {\n        mimeType: 'audio/webm'\n      });\n      audioChunksRef.current = [];\n      mediaRecorderRef.current.ondataavailable = event => {\n        if (event.data.size > 0) {\n          audioChunksRef.current.push(event.data);\n        }\n      };\n      mediaRecorderRef.current.onstop = async () => {\n        const audioBlob = new Blob(audioChunksRef.current, {\n          type: 'audio/webm'\n        });\n        await processAudioBlob(audioBlob);\n\n        // Stop all tracks\n        stream.getTracks().forEach(track => track.stop());\n      };\n      mediaRecorderRef.current.start();\n      setIsListening(true);\n      setError('');\n      console.log('Recording started');\n    } catch (err) {\n      console.error('Recording error:', err);\n      setError('Failed to access microphone. Please grant permission and try again.');\n    }\n  };\n  const stopRecording = () => {\n    if (mediaRecorderRef.current && isListening) {\n      mediaRecorderRef.current.stop();\n      setIsListening(false);\n      console.log('Recording stopped');\n    }\n  };\n  const processAudioBlob = async audioBlob => {\n    setIsProcessingSpeech(true);\n    setError('');\n    try {\n      // Convert to base64\n      const reader = new FileReader();\n      reader.readAsDataURL(audioBlob);\n      reader.onloadend = async () => {\n        const base64Audio = reader.result;\n        console.log('Sending audio to unified endpoint...');\n        const response = await fetch('/api/ai/enhance-description', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          credentials: 'include',\n          body: JSON.stringify({\n            audio: base64Audio,\n            language: selectedLanguage\n          })\n        });\n        const data = await response.json();\n        if (data.success) {\n          var _supportedLanguages$f;\n          // Use enhanced_description from unified endpoint\n          const newDescription = data.enhanced_description || data.speech_translated_text || data.speech_original_text;\n          if (description.trim()) {\n            // Add space if there's existing content\n            setDescription(prev => prev.trim() + ' ' + newDescription);\n          } else {\n            setDescription(newDescription);\n          }\n          const langName = ((_supportedLanguages$f = supportedLanguages.find(l => l.code === selectedLanguage)) === null || _supportedLanguages$f === void 0 ? void 0 : _supportedLanguages$f.name) || 'selected language';\n\n          // Log speech processing details\n          if (data.input_type === 'speech') {\n            console.log('Speech processing complete:', {\n              original: data.speech_original_text,\n              translated: data.speech_translated_text,\n              enhanced: data.enhanced_description,\n              language: data.speech_language\n            });\n          }\n          setSuccess(`‚úì Voice input processed and enhanced (${langName})`);\n          setTimeout(() => setSuccess(''), 3000);\n        } else {\n          // Handle different error types\n          if (data.error_type === 'OLLAMA_OFFLINE') {\n            setError('AI model is offline. Please start Ollama and ensure Llama 3.2:3b is installed.');\n          } else if (data.error_type === 'EMPTY_AUDIO') {\n            setError('No speech detected. Please speak clearly and try again.');\n          } else if (data.error_type === 'EMPTY_TRANSCRIPTION') {\n            setError('No speech detected in audio. Please speak clearly and try again.');\n          } else if (data.error_type === 'MODEL_LOAD_ERROR') {\n            setError('Failed to load speech model. Model may be downloading (first time use).');\n          } else {\n            setError(data.error || 'Failed to process speech');\n          }\n        }\n      };\n      reader.onerror = () => {\n        setError('Failed to read audio file');\n        setIsProcessingSpeech(false);\n      };\n    } catch (err) {\n      console.error('Speech processing error:', err);\n      setError('Network error. Please check your connection.');\n      setIsProcessingSpeech(false);\n    } finally {\n      setIsProcessingSpeech(false);\n    }\n  };\n  const handleEnhance = async () => {\n    if (!description.trim()) {\n      setError('Please enter or speak a description first');\n      return;\n    }\n    setIsEnhancing(true);\n    setError('');\n    setSuccess('');\n    try {\n      const response = await fetch('/api/ai/enhance-description', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          description: description.trim()\n        })\n      });\n      const data = await response.json();\n      if (data.success) {\n        setDescription(data.enhanced_description);\n        setSuccess('‚úì Description enhanced with AI');\n        setTimeout(() => setSuccess(''), 3000);\n      } else {\n        if (data.error_type === 'OLLAMA_OFFLINE') {\n          setError('AI model is offline. Please start Ollama and ensure Llama 3.2:3b is installed.');\n        } else {\n          setError(data.error || 'Failed to enhance description');\n        }\n      }\n    } catch (err) {\n      console.error('Enhancement error:', err);\n      setError('Network error. Please check your connection.');\n    } finally {\n      setIsEnhancing(false);\n    }\n  };\n  const handleManualInput = e => {\n    // User can type freely at any time\n    setDescription(e.target.value);\n    setError(''); // Clear errors when user starts typing\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"maintenance-input-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"input-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Maintenance Description\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"input-hint\",\n        children: \"Type, speak, or enhance with AI\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"language-selector\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"language-select\",\n        children: \"Voice Language:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"language-select\",\n        value: selectedLanguage,\n        onChange: e => setSelectedLanguage(e.target.value),\n        disabled: isListening || isProcessingSpeech,\n        className: \"language-dropdown\",\n        children: supportedLanguages.map(lang => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: lang.code,\n          children: [lang.native, \" (\", lang.name, \")\"]\n        }, lang.code, true, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n      className: \"description-textarea\",\n      value: description,\n      onChange: handleManualInput,\n      placeholder: \"Type description here or use voice input...\",\n      rows: 6,\n      disabled: isListening || isProcessingSpeech || isEnhancing\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"control-buttons\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: `voice-button ${isListening ? 'recording' : ''}`,\n        onClick: isListening ? stopRecording : startRecording,\n        disabled: isProcessingSpeech || isEnhancing || !speechSupported,\n        title: speechSupported ? 'Voice input' : 'Voice input not supported',\n        children: isListening ? '‚èπÔ∏è Stop' : 'üé§ Voice Input'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"enhance-button\",\n        onClick: handleEnhance,\n        disabled: isEnhancing || isListening || isProcessingSpeech || !description.trim(),\n        children: isEnhancing ? '‚è≥ Enhancing...' : '‚ú® Enhance with AI'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 7\n    }, this), isProcessingSpeech && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"processing-indicator\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"Processing speech (ASR \\u2192 Translation \\u2192 Enhancement)...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 9\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: [\"\\u274C \", error]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 9\n    }, this), success && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"success-message\",\n      children: success\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"help-text\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"How to use:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 12\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Type:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 15\n          }, this), \" Enter description manually\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Voice:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 15\n          }, this), \" Select language, click mic, speak, then stop\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Enhance:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 15\n          }, this), \" Use AI to improve any text professionally\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 257,\n    columnNumber: 5\n  }, this);\n};\n_s(MaintenanceInput, \"ta72SVBcySSp1TunlvO9Yep0hoc=\");\n_c = MaintenanceInput;\nexport default MaintenanceInput;\nconst startRecording = async () => {\n  if (!speechSupported) {\n    setError('Audio recording is not supported in your browser. Please use Chrome, Edge, or Firefox.');\n    return;\n  }\n  try {\n    const stream = await navigator.mediaDevices.getUserMedia({\n      audio: {\n        echoCancellation: true,\n        noiseSuppression: true,\n        sampleRate: 16000\n      }\n    });\n\n    // Check if WAV is supported, fallback to webm\n    let mimeType = 'audio/webm';\n    if (MediaRecorder.isTypeSupported('audio/wav')) {\n      mimeType = 'audio/wav';\n    } else if (MediaRecorder.isTypeSupported('audio/webm;codecs=opus')) {\n      mimeType = 'audio/webm;codecs=opus';\n    }\n    mediaRecorderRef.current = new MediaRecorder(stream, {\n      mimeType: mimeType\n    });\n    audioChunksRef.current = [];\n    mediaRecorderRef.current.ondataavailable = event => {\n      if (event.data.size > 0) {\n        audioChunksRef.current.push(event.data);\n      }\n    };\n    mediaRecorderRef.current.onstop = async () => {\n      const audioBlob = new Blob(audioChunksRef.current, {\n        type: mimeType\n      });\n      await processAudioBlob(audioBlob);\n\n      // Stop all tracks\n      stream.getTracks().forEach(track => track.stop());\n    };\n    mediaRecorderRef.current.start();\n    setIsListening(true);\n    setError('');\n    console.log('Recording started with format:', mimeType);\n  } catch (err) {\n    console.error('Recording error:', err);\n    setError('Failed to access microphone. Please grant permission and try again.');\n  }\n};\nvar _c;\n$RefreshReg$(_c, \"MaintenanceInput\");","map":{"version":3,"names":["React","useState","useEffect","useRef","jsxDEV","_jsxDEV","MaintenanceInput","onSubmit","initialValue","_s","description","setDescription","isListening","setIsListening","isEnhancing","setIsEnhancing","isProcessingSpeech","setIsProcessingSpeech","speechSupported","setSpeechSupported","selectedLanguage","setSelectedLanguage","supportedLanguages","setSupportedLanguages","error","setError","success","setSuccess","mediaRecorderRef","audioChunksRef","fetchSupportedLanguages","checkAudioSupport","response","fetch","credentials","data","json","languages","err","console","code","name","native","_navigator$mediaDevic","hasMediaRecorder","navigator","mediaDevices","getUserMedia","warn","startRecording","stream","audio","echoCancellation","noiseSuppression","sampleRate","current","MediaRecorder","mimeType","ondataavailable","event","size","push","onstop","audioBlob","Blob","type","processAudioBlob","getTracks","forEach","track","stop","start","log","stopRecording","reader","FileReader","readAsDataURL","onloadend","base64Audio","result","method","headers","body","JSON","stringify","language","_supportedLanguages$f","newDescription","enhanced_description","speech_translated_text","speech_original_text","trim","prev","langName","find","l","input_type","original","translated","enhanced","speech_language","setTimeout","error_type","onerror","handleEnhance","handleManualInput","e","target","value","className","children","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","id","onChange","disabled","map","lang","placeholder","rows","onClick","title","_c","isTypeSupported","$RefreshReg$"],"sources":["C:/QRail/Frontend/src/components/Maintenance/MaintenanceInput.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport './MaintenanceInput.css';\r\n\r\nconst MaintenanceInput = ({ onSubmit, initialValue = '' }) => {\r\n  const [description, setDescription] = useState(initialValue);\r\n  const [isListening, setIsListening] = useState(false);\r\n  const [isEnhancing, setIsEnhancing] = useState(false);\r\n  const [isProcessingSpeech, setIsProcessingSpeech] = useState(false);\r\n  const [speechSupported, setSpeechSupported] = useState(false);\r\n  const [selectedLanguage, setSelectedLanguage] = useState('hi');\r\n  const [supportedLanguages, setSupportedLanguages] = useState([]);\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n  \r\n  const mediaRecorderRef = useRef(null);\r\n  const audioChunksRef = useRef([]);\r\n\r\n  // Sync with parent's initialValue changes\r\n  useEffect(() => {\r\n    setDescription(initialValue);\r\n  }, [initialValue]);\r\n\r\n  // Notify parent of description changes\r\n  useEffect(() => {\r\n    if (onSubmit) {\r\n      onSubmit(description);\r\n    }\r\n  }, [description, onSubmit]);\r\n\r\n  // Load supported languages on mount\r\n  useEffect(() => {\r\n    fetchSupportedLanguages();\r\n    checkAudioSupport();\r\n  }, []);\r\n\r\n  const fetchSupportedLanguages = async () => {\r\n    try {\r\n      const response = await fetch('/api/speech/languages', {\r\n        credentials: 'include'\r\n      });\r\n      const data = await response.json();\r\n      \r\n      if (data.success) {\r\n        setSupportedLanguages(data.languages);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to load languages:', err);\r\n      // Fallback languages\r\n      setSupportedLanguages([\r\n        { code: 'hi', name: 'Hindi', native: '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä' },\r\n        { code: 'gu', name: 'Gujarati', native: '‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä' },\r\n        { code: 'ta', name: 'Tamil', native: '‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç' },\r\n        { code: 'te', name: 'Telugu', native: '‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å' },\r\n        { code: 'bn', name: 'Bengali', native: '‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ' },\r\n        { code: 'mr', name: 'Marathi', native: '‡§Æ‡§∞‡§æ‡§†‡•Ä' },\r\n        { code: 'kn', name: 'Kannada', native: '‡≤ï‡≤®‡≥ç‡≤®‡≤°' },\r\n        { code: 'ml', name: 'Malayalam', native: '‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç' },\r\n        { code: 'pa', name: 'Punjabi', native: '‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä' },\r\n        { code: 'or', name: 'Odia', native: '‡¨ì‡¨°‡¨º‡¨ø‡¨Ü' }\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const checkAudioSupport = () => {\r\n    const hasMediaRecorder = !!navigator.mediaDevices?.getUserMedia;\r\n    setSpeechSupported(hasMediaRecorder);\r\n    \r\n    if (!hasMediaRecorder) {\r\n      console.warn('MediaRecorder API not supported in this browser');\r\n    }\r\n  };\r\n\r\n  const startRecording = async () => {\r\n    if (!speechSupported) {\r\n      setError('Audio recording is not supported in your browser. Please use Chrome, Edge, or Firefox.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({\r\n        audio: {\r\n          echoCancellation: true,\r\n          noiseSuppression: true,\r\n          sampleRate: 16000\r\n        }\r\n      });\r\n\r\n      mediaRecorderRef.current = new MediaRecorder(stream, {\r\n        mimeType: 'audio/webm'\r\n      });\r\n\r\n      audioChunksRef.current = [];\r\n\r\n      mediaRecorderRef.current.ondataavailable = (event) => {\r\n        if (event.data.size > 0) {\r\n          audioChunksRef.current.push(event.data);\r\n        }\r\n      };\r\n\r\n      mediaRecorderRef.current.onstop = async () => {\r\n        const audioBlob = new Blob(audioChunksRef.current, { type: 'audio/webm' });\r\n        await processAudioBlob(audioBlob);\r\n        \r\n        // Stop all tracks\r\n        stream.getTracks().forEach(track => track.stop());\r\n      };\r\n\r\n      mediaRecorderRef.current.start();\r\n      setIsListening(true);\r\n      setError('');\r\n      console.log('Recording started');\r\n    } catch (err) {\r\n      console.error('Recording error:', err);\r\n      setError('Failed to access microphone. Please grant permission and try again.');\r\n    }\r\n  };\r\n\r\n  const stopRecording = () => {\r\n    if (mediaRecorderRef.current && isListening) {\r\n      mediaRecorderRef.current.stop();\r\n      setIsListening(false);\r\n      console.log('Recording stopped');\r\n    }\r\n  };\r\n\r\n  const processAudioBlob = async (audioBlob) => {\r\n    setIsProcessingSpeech(true);\r\n    setError('');\r\n\r\n    try {\r\n      // Convert to base64\r\n      const reader = new FileReader();\r\n      reader.readAsDataURL(audioBlob);\r\n      \r\n      reader.onloadend = async () => {\r\n        const base64Audio = reader.result;\r\n        console.log('Sending audio to unified endpoint...');\r\n\r\n        const response = await fetch('/api/ai/enhance-description', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n          credentials: 'include',\r\n          body: JSON.stringify({\r\n            audio: base64Audio,\r\n            language: selectedLanguage\r\n          }),\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (data.success) {\r\n          // Use enhanced_description from unified endpoint\r\n          const newDescription = data.enhanced_description || data.speech_translated_text || data.speech_original_text;\r\n          \r\n          if (description.trim()) {\r\n            // Add space if there's existing content\r\n            setDescription(prev => prev.trim() + ' ' + newDescription);\r\n          } else {\r\n            setDescription(newDescription);\r\n          }\r\n\r\n          const langName = supportedLanguages.find(l => l.code === selectedLanguage)?.name || 'selected language';\r\n          \r\n          // Log speech processing details\r\n          if (data.input_type === 'speech') {\r\n            console.log('Speech processing complete:', {\r\n              original: data.speech_original_text,\r\n              translated: data.speech_translated_text,\r\n              enhanced: data.enhanced_description,\r\n              language: data.speech_language\r\n            });\r\n          }\r\n\r\n          setSuccess(`‚úì Voice input processed and enhanced (${langName})`);\r\n          setTimeout(() => setSuccess(''), 3000);\r\n        } else {\r\n          // Handle different error types\r\n          if (data.error_type === 'OLLAMA_OFFLINE') {\r\n            setError('AI model is offline. Please start Ollama and ensure Llama 3.2:3b is installed.');\r\n          } else if (data.error_type === 'EMPTY_AUDIO') {\r\n            setError('No speech detected. Please speak clearly and try again.');\r\n          } else if (data.error_type === 'EMPTY_TRANSCRIPTION') {\r\n            setError('No speech detected in audio. Please speak clearly and try again.');\r\n          } else if (data.error_type === 'MODEL_LOAD_ERROR') {\r\n            setError('Failed to load speech model. Model may be downloading (first time use).');\r\n          } else {\r\n            setError(data.error || 'Failed to process speech');\r\n          }\r\n        }\r\n      };\r\n\r\n      reader.onerror = () => {\r\n        setError('Failed to read audio file');\r\n        setIsProcessingSpeech(false);\r\n      };\r\n    } catch (err) {\r\n      console.error('Speech processing error:', err);\r\n      setError('Network error. Please check your connection.');\r\n      setIsProcessingSpeech(false);\r\n    } finally {\r\n      setIsProcessingSpeech(false);\r\n    }\r\n  };\r\n\r\n  const handleEnhance = async () => {\r\n    if (!description.trim()) {\r\n      setError('Please enter or speak a description first');\r\n      return;\r\n    }\r\n\r\n    setIsEnhancing(true);\r\n    setError('');\r\n    setSuccess('');\r\n\r\n    try {\r\n      const response = await fetch('/api/ai/enhance-description', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n        body: JSON.stringify({\r\n          description: description.trim()\r\n        }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        setDescription(data.enhanced_description);\r\n        setSuccess('‚úì Description enhanced with AI');\r\n        setTimeout(() => setSuccess(''), 3000);\r\n      } else {\r\n        if (data.error_type === 'OLLAMA_OFFLINE') {\r\n          setError('AI model is offline. Please start Ollama and ensure Llama 3.2:3b is installed.');\r\n        } else {\r\n          setError(data.error || 'Failed to enhance description');\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Enhancement error:', err);\r\n      setError('Network error. Please check your connection.');\r\n    } finally {\r\n      setIsEnhancing(false);\r\n    }\r\n  };\r\n\r\n  const handleManualInput = (e) => {\r\n    // User can type freely at any time\r\n    setDescription(e.target.value);\r\n    setError(''); // Clear errors when user starts typing\r\n  };\r\n\r\n  return (\r\n    <div className=\"maintenance-input-container\">\r\n      <div className=\"input-header\">\r\n        <h3>Maintenance Description</h3>\r\n        <span className=\"input-hint\">Type, speak, or enhance with AI</span>\r\n      </div>\r\n\r\n      {/* Language Selection */}\r\n      <div className=\"language-selector\">\r\n        <label htmlFor=\"language-select\">Voice Language:</label>\r\n        <select\r\n          id=\"language-select\"\r\n          value={selectedLanguage}\r\n          onChange={(e) => setSelectedLanguage(e.target.value)}\r\n          disabled={isListening || isProcessingSpeech}\r\n          className=\"language-dropdown\"\r\n        >\r\n          {supportedLanguages.map((lang) => (\r\n            <option key={lang.code} value={lang.code}>\r\n              {lang.native} ({lang.name})\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Text Input Area */}\r\n      <textarea\r\n        className=\"description-textarea\"\r\n        value={description}\r\n        onChange={handleManualInput}\r\n        placeholder=\"Type description here or use voice input...\"\r\n        rows={6}\r\n        disabled={isListening || isProcessingSpeech || isEnhancing}\r\n      />\r\n\r\n      {/* Control Buttons */}\r\n      <div className=\"control-buttons\">\r\n        {/* Voice Input Button */}\r\n        <button\r\n          className={`voice-button ${isListening ? 'recording' : ''}`}\r\n          onClick={isListening ? stopRecording : startRecording}\r\n          disabled={isProcessingSpeech || isEnhancing || !speechSupported}\r\n          title={speechSupported ? 'Voice input' : 'Voice input not supported'}\r\n        >\r\n          {isListening ? '‚èπÔ∏è Stop' : 'üé§ Voice Input'}\r\n        </button>\r\n\r\n        {/* Enhance Button */}\r\n        <button\r\n          className=\"enhance-button\"\r\n          onClick={handleEnhance}\r\n          disabled={isEnhancing || isListening || isProcessingSpeech || !description.trim()}\r\n        >\r\n          {isEnhancing ? '‚è≥ Enhancing...' : '‚ú® Enhance with AI'}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Processing Indicator */}\r\n      {isProcessingSpeech && (\r\n        <div className=\"processing-indicator\">\r\n          <span className=\"spinner\"></span>\r\n          <span>Processing speech (ASR ‚Üí Translation ‚Üí Enhancement)...</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Error Message */}\r\n      {error && (\r\n        <div className=\"error-message\">\r\n          ‚ùå {error}\r\n        </div>\r\n      )}\r\n\r\n      {/* Success Message */}\r\n      {success && (\r\n        <div className=\"success-message\">\r\n          {success}\r\n        </div>\r\n      )}\r\n\r\n      {/* Help Text */}\r\n      <div className=\"help-text\">\r\n        <p><strong>How to use:</strong></p>\r\n        <ul>\r\n          <li><strong>Type:</strong> Enter description manually</li>\r\n          <li><strong>Voice:</strong> Select language, click mic, speak, then stop</li>\r\n          <li><strong>Enhance:</strong> Use AI to improve any text professionally</li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MaintenanceInput;\r\n\r\nconst startRecording = async () => {\r\n  if (!speechSupported) {\r\n    setError('Audio recording is not supported in your browser. Please use Chrome, Edge, or Firefox.');\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const stream = await navigator.mediaDevices.getUserMedia({\r\n      audio: {\r\n        echoCancellation: true,\r\n        noiseSuppression: true,\r\n        sampleRate: 16000\r\n      }\r\n    });\r\n\r\n    // Check if WAV is supported, fallback to webm\r\n    let mimeType = 'audio/webm';\r\n    if (MediaRecorder.isTypeSupported('audio/wav')) {\r\n      mimeType = 'audio/wav';\r\n    } else if (MediaRecorder.isTypeSupported('audio/webm;codecs=opus')) {\r\n      mimeType = 'audio/webm;codecs=opus';\r\n    }\r\n\r\n    mediaRecorderRef.current = new MediaRecorder(stream, {\r\n      mimeType: mimeType\r\n    });\r\n\r\n    audioChunksRef.current = [];\r\n\r\n    mediaRecorderRef.current.ondataavailable = (event) => {\r\n      if (event.data.size > 0) {\r\n        audioChunksRef.current.push(event.data);\r\n      }\r\n    };\r\n\r\n    mediaRecorderRef.current.onstop = async () => {\r\n      const audioBlob = new Blob(audioChunksRef.current, { type: mimeType });\r\n      await processAudioBlob(audioBlob);\r\n      \r\n      // Stop all tracks\r\n      stream.getTracks().forEach(track => track.stop());\r\n    };\r\n\r\n    mediaRecorderRef.current.start();\r\n    setIsListening(true);\r\n    setError('');\r\n    console.log('Recording started with format:', mimeType);\r\n  } catch (err) {\r\n    console.error('Recording error:', err);\r\n    setError('Failed to access microphone. Please grant permission and try again.');\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}