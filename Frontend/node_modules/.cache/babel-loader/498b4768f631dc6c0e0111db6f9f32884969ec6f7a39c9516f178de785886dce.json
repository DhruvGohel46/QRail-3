{"ast":null,"code":"var _jsxFileName = \"C:\\\\QRail\\\\Frontend\\\\src\\\\components\\\\Maintenance\\\\QRScanner.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport api from '../../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst QRScanner = ({\n  isOpen,\n  onClose,\n  onScanComplete\n}) => {\n  _s();\n  const [scanning, setScanning] = useState(false);\n  const [error, setError] = useState('');\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const streamRef = useRef(null);\n  const scanIntervalRef = useRef(null);\n  const isScanningRef = useRef(false);\n  const frameCountRef = useRef(0);\n  const onScanCompleteRef = useRef(onScanComplete);\n\n  // Keep callback ref updated\n  useEffect(() => {\n    onScanCompleteRef.current = onScanComplete;\n  }, [onScanComplete]);\n  const stopScanner = useCallback(async () => {\n    isScanningRef.current = false;\n\n    // Clear scanning interval\n    if (scanIntervalRef.current) {\n      clearInterval(scanIntervalRef.current);\n      scanIntervalRef.current = null;\n    }\n\n    // Stop camera stream\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach(track => track.stop());\n      streamRef.current = null;\n    }\n    setScanning(false);\n  }, []);\n  const captureAndScanFrame = useCallback(async () => {\n    if (!isScanningRef.current || !videoRef.current || !canvasRef.current) {\n      return;\n    }\n    try {\n      const video = videoRef.current;\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n\n      // Set canvas dimensions to match video\n      canvas.width = video.videoWidth;\n      canvas.height = video.videoHeight;\n\n      // Draw video frame to canvas\n      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n      // Convert canvas to base64 image\n      const imageData = canvas.toDataURL('image/jpeg', 0.8);\n      frameCountRef.current += 1;\n\n      // Send frame to backend for QR scanning\n      try {\n        const result = await api.qr.scanFromFrame(imageData);\n        if (result.success && result.assetId && result.asset) {\n          console.log('Valid QR code detected:', result.assetId);\n          await stopScanner();\n          clearInterval(scanIntervalRef.current);\n          onScanCompleteRef.current(result.assetId);\n          return; // Stop processing more frames\n        } else if (result.error === \"Asset not found in database\") {\n          setError(\"Invalid QR code: Asset not found in database\");\n          await stopScanner();\n          return;\n        }\n        // If not successful, continue scanning\n      } catch (err) {\n        var _err$message;\n        if ((_err$message = err.message) !== null && _err$message !== void 0 && _err$message.includes('404')) {\n          setError(\"Invalid QR code: Asset not found\");\n          await stopScanner();\n          return;\n        }\n        // Other network errors during scanning can be ignored\n      }\n    } catch (err) {\n      // Log error but continue scanning\n      if (frameCountRef.current % 30 === 0) {\n        // Only log every 30 frames to avoid spam\n        console.debug('Scan error:', err.message);\n      }\n    }\n  }, [stopScanner]);\n  const startScanner = useCallback(async () => {\n    if (isScanningRef.current) {\n      return; // Already scanning\n    }\n    try {\n      setError('');\n      setScanning(true);\n      isScanningRef.current = true;\n      frameCountRef.current = 0;\n\n      // Request camera access\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          // Use back camera\n          width: {\n            ideal: 1280\n          },\n          height: {\n            ideal: 720\n          }\n        }\n      });\n      streamRef.current = stream;\n\n      // Set video source\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n        videoRef.current.play();\n\n        // Wait for video to be ready\n        await new Promise(resolve => {\n          if (videoRef.current.readyState >= 2) {\n            resolve();\n          } else {\n            videoRef.current.addEventListener('loadedmetadata', resolve, {\n              once: true\n            });\n          }\n        });\n\n        // Start continuous scanning loop\n        // Scan every 200ms (5 frames per second) to balance performance and responsiveness\n        scanIntervalRef.current = setInterval(() => {\n          if (isScanningRef.current) {\n            captureAndScanFrame();\n          }\n        }, 200);\n      }\n    } catch (err) {\n      console.error('Scanner error:', err);\n      setError('Failed to start camera. Please check permissions and ensure camera is available. Error: ' + err.message);\n      setScanning(false);\n      isScanningRef.current = false;\n\n      // Clean up on error\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n        streamRef.current = null;\n      }\n    }\n  }, [captureAndScanFrame]);\n  useEffect(() => {\n    if (isOpen) {\n      // Small delay to ensure DOM is ready\n      const timer = setTimeout(() => {\n        startScanner();\n      }, 300);\n      return () => {\n        clearTimeout(timer);\n        stopScanner();\n      };\n    } else {\n      stopScanner();\n    }\n  }, [isOpen, startScanner, stopScanner]);\n  if (!isOpen) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"modal show\",\n    onClick: onClose,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-content\",\n      onClick: e => e.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Scan QR Code\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"close-btn\",\n          onClick: onClose,\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"material-icons-round\",\n            children: \"close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-body\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'relative',\n            width: '100%',\n            maxWidth: '500px',\n            margin: '0 auto'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"video\", {\n            ref: videoRef,\n            autoPlay: true,\n            playsInline: true,\n            muted: true,\n            style: {\n              width: '100%',\n              height: 'auto',\n              borderRadius: '12px',\n              backgroundColor: '#000',\n              display: scanning && !error ? 'block' : 'none'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n            ref: canvasRef,\n            style: {\n              display: 'none'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 13\n          }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"error-message\",\n            style: {\n              marginTop: 16,\n              color: '#f44336',\n              padding: '12px',\n              background: '#ffebee',\n              borderRadius: '8px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"material-icons-round\",\n              style: {\n                verticalAlign: 'middle',\n                marginRight: '8px'\n              },\n              children: \"error_outline\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 17\n            }, this), error]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 15\n          }, this), scanning && !error && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: 16,\n              textAlign: 'center',\n              color: '#666',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              gap: '8px',\n              padding: '12px',\n              background: '#E3F2FD',\n              borderRadius: '8px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"material-icons-round\",\n              style: {\n                animation: 'pulse 2s infinite',\n                color: '#1976D2'\n              },\n              children: \"qr_code_scanner\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Position QR code within the frame\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 15\n          }, this), !scanning && !error && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: 16,\n              textAlign: 'center',\n              color: '#666',\n              padding: '40px',\n              background: '#F5F5F5',\n              borderRadius: '12px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"material-icons-round\",\n              style: {\n                fontSize: '48px',\n                color: '#999',\n                marginBottom: '12px'\n              },\n              children: \"camera_alt\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Initializing camera...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-actions\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"md-button outline\",\n          onClick: onClose,\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 171,\n    columnNumber: 5\n  }, this);\n};\n_s(QRScanner, \"1cqTZ79zGs6TKaD/O5bg5OVb694=\");\n_c = QRScanner;\nexport default QRScanner;\nvar _c;\n$RefreshReg$(_c, \"QRScanner\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","api","jsxDEV","_jsxDEV","QRScanner","isOpen","onClose","onScanComplete","_s","scanning","setScanning","error","setError","videoRef","canvasRef","streamRef","scanIntervalRef","isScanningRef","frameCountRef","onScanCompleteRef","current","stopScanner","clearInterval","getTracks","forEach","track","stop","captureAndScanFrame","video","canvas","ctx","getContext","width","videoWidth","height","videoHeight","drawImage","imageData","toDataURL","result","qr","scanFromFrame","success","assetId","asset","console","log","err","_err$message","message","includes","debug","startScanner","stream","navigator","mediaDevices","getUserMedia","facingMode","ideal","srcObject","play","Promise","resolve","readyState","addEventListener","once","setInterval","timer","setTimeout","clearTimeout","className","onClick","children","e","stopPropagation","fileName","_jsxFileName","lineNumber","columnNumber","style","position","maxWidth","margin","ref","autoPlay","playsInline","muted","borderRadius","backgroundColor","display","marginTop","color","padding","background","verticalAlign","marginRight","textAlign","alignItems","justifyContent","gap","animation","fontSize","marginBottom","_c","$RefreshReg$"],"sources":["C:/QRail/Frontend/src/components/Maintenance/QRScanner.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport api from '../../services/api';\r\n\r\nconst QRScanner = ({ isOpen, onClose, onScanComplete }) => {\r\n  const [scanning, setScanning] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const videoRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n  const streamRef = useRef(null);\r\n  const scanIntervalRef = useRef(null);\r\n  const isScanningRef = useRef(false);\r\n  const frameCountRef = useRef(0);\r\n  const onScanCompleteRef = useRef(onScanComplete);\r\n\r\n  // Keep callback ref updated\r\n  useEffect(() => {\r\n    onScanCompleteRef.current = onScanComplete;\r\n  }, [onScanComplete]);\r\n\r\n  const stopScanner = useCallback(async () => {\r\n    isScanningRef.current = false;\r\n    \r\n    // Clear scanning interval\r\n    if (scanIntervalRef.current) {\r\n      clearInterval(scanIntervalRef.current);\r\n      scanIntervalRef.current = null;\r\n    }\r\n\r\n    // Stop camera stream\r\n    if (streamRef.current) {\r\n      streamRef.current.getTracks().forEach(track => track.stop());\r\n      streamRef.current = null;\r\n    }\r\n\r\n    setScanning(false);\r\n  }, []);\r\n\r\n  const captureAndScanFrame = useCallback(async () => {\r\n    if (!isScanningRef.current || !videoRef.current || !canvasRef.current) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const video = videoRef.current;\r\n      const canvas = canvasRef.current;\r\n      const ctx = canvas.getContext('2d');\r\n\r\n      // Set canvas dimensions to match video\r\n      canvas.width = video.videoWidth;\r\n      canvas.height = video.videoHeight;\r\n\r\n      // Draw video frame to canvas\r\n      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n\r\n      // Convert canvas to base64 image\r\n      const imageData = canvas.toDataURL('image/jpeg', 0.8);\r\n      \r\n      frameCountRef.current += 1;\r\n\r\n      // Send frame to backend for QR scanning\r\n      try {\r\n        const result = await api.qr.scanFromFrame(imageData);\r\n\r\n        if (result.success && result.assetId && result.asset) {\r\n          console.log('Valid QR code detected:', result.assetId);\r\n          await stopScanner();\r\n          clearInterval(scanIntervalRef.current);\r\n          onScanCompleteRef.current(result.assetId);\r\n          return; // Stop processing more frames\r\n        } else if (result.error === \"Asset not found in database\") {\r\n          setError(\"Invalid QR code: Asset not found in database\");\r\n          await stopScanner();\r\n          return;\r\n        }\r\n        // If not successful, continue scanning\r\n      } catch (err) {\r\n        if (err.message?.includes('404')) {\r\n          setError(\"Invalid QR code: Asset not found\");\r\n          await stopScanner();\r\n          return;\r\n        }\r\n        // Other network errors during scanning can be ignored\r\n      }\r\n      \r\n    } catch (err) {\r\n      // Log error but continue scanning\r\n      if (frameCountRef.current % 30 === 0) { // Only log every 30 frames to avoid spam\r\n        console.debug('Scan error:', err.message);\r\n      }\r\n    }\r\n  }, [stopScanner]);\r\n\r\n  const startScanner = useCallback(async () => {\r\n    if (isScanningRef.current) {\r\n      return; // Already scanning\r\n    }\r\n\r\n    try {\r\n      setError('');\r\n      setScanning(true);\r\n      isScanningRef.current = true;\r\n      frameCountRef.current = 0;\r\n\r\n      // Request camera access\r\n      const stream = await navigator.mediaDevices.getUserMedia({\r\n        video: {\r\n          facingMode: 'environment', // Use back camera\r\n          width: { ideal: 1280 },\r\n          height: { ideal: 720 }\r\n        }\r\n      });\r\n\r\n      streamRef.current = stream;\r\n\r\n      // Set video source\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = stream;\r\n        videoRef.current.play();\r\n\r\n        // Wait for video to be ready\r\n        await new Promise((resolve) => {\r\n          if (videoRef.current.readyState >= 2) {\r\n            resolve();\r\n          } else {\r\n            videoRef.current.addEventListener('loadedmetadata', resolve, { once: true });\r\n          }\r\n        });\r\n\r\n        // Start continuous scanning loop\r\n        // Scan every 200ms (5 frames per second) to balance performance and responsiveness\r\n        scanIntervalRef.current = setInterval(() => {\r\n          if (isScanningRef.current) {\r\n            captureAndScanFrame();\r\n          }\r\n        }, 200);\r\n      }\r\n\r\n    } catch (err) {\r\n      console.error('Scanner error:', err);\r\n      setError('Failed to start camera. Please check permissions and ensure camera is available. Error: ' + err.message);\r\n      setScanning(false);\r\n      isScanningRef.current = false;\r\n      \r\n      // Clean up on error\r\n      if (streamRef.current) {\r\n        streamRef.current.getTracks().forEach(track => track.stop());\r\n        streamRef.current = null;\r\n      }\r\n    }\r\n  }, [captureAndScanFrame]);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      // Small delay to ensure DOM is ready\r\n      const timer = setTimeout(() => {\r\n        startScanner();\r\n      }, 300);\r\n      \r\n      return () => {\r\n        clearTimeout(timer);\r\n        stopScanner();\r\n      };\r\n    } else {\r\n      stopScanner();\r\n    }\r\n  }, [isOpen, startScanner, stopScanner]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"modal show\" onClick={onClose}>\r\n      <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\r\n        <div className=\"modal-header\">\r\n          <h3>Scan QR Code</h3>\r\n          <button className=\"close-btn\" onClick={onClose}>\r\n            <span className=\"material-icons-round\">close</span>\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"modal-body\">\r\n          <div style={{ position: 'relative', width: '100%', maxWidth: '500px', margin: '0 auto' }}>\r\n            {/* Video element for camera feed */}\r\n            <video\r\n              ref={videoRef}\r\n              autoPlay\r\n              playsInline\r\n              muted\r\n              style={{\r\n                width: '100%',\r\n                height: 'auto',\r\n                borderRadius: '12px',\r\n                backgroundColor: '#000',\r\n                display: scanning && !error ? 'block' : 'none'\r\n              }}\r\n            />\r\n            \r\n            {/* Hidden canvas for frame capture */}\r\n            <canvas\r\n              ref={canvasRef}\r\n              style={{ display: 'none' }}\r\n            />\r\n\r\n            {/* Loading/Error states */}\r\n            {error && (\r\n              <div className=\"error-message\" style={{ marginTop: 16, color: '#f44336', padding: '12px', background: '#ffebee', borderRadius: '8px' }}>\r\n                <span className=\"material-icons-round\" style={{ verticalAlign: 'middle', marginRight: '8px' }}>error_outline</span>\r\n                {error}\r\n              </div>\r\n            )}\r\n            \r\n            {scanning && !error && (\r\n              <div style={{ \r\n                marginTop: 16, \r\n                textAlign: 'center', \r\n                color: '#666', \r\n                display: 'flex', \r\n                alignItems: 'center', \r\n                justifyContent: 'center', \r\n                gap: '8px',\r\n                padding: '12px',\r\n                background: '#E3F2FD',\r\n                borderRadius: '8px'\r\n              }}>\r\n                <span className=\"material-icons-round\" style={{ animation: 'pulse 2s infinite', color: '#1976D2' }}>qr_code_scanner</span>\r\n                <span>Position QR code within the frame</span>\r\n              </div>\r\n            )}\r\n            \r\n            {!scanning && !error && (\r\n              <div style={{ \r\n                marginTop: 16, \r\n                textAlign: 'center', \r\n                color: '#666',\r\n                padding: '40px',\r\n                background: '#F5F5F5',\r\n                borderRadius: '12px'\r\n              }}>\r\n                <span className=\"material-icons-round\" style={{ fontSize: '48px', color: '#999', marginBottom: '12px' }}>camera_alt</span>\r\n                <p>Initializing camera...</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"modal-actions\">\r\n          <button className=\"md-button outline\" onClick={onClose}>\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default QRScanner;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}